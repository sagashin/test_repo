---
title: Sep2023 Reserving - 2nd Opinion by ADJ RM
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
---


```{r, echo=FALSE, waring=FALSE, message=FALSE, include=FALSE}
#Import Library
end_date <- "2023/09/01" #日は月末の1日としている（プログラムの都合上）

library(haven)
library(dplyr)
library(tidyverse)
library(data.table)
library(reshape2)
library(ggplot2)
library(directlabels)
library(GGally)
library(readxl)
library(pdftools)
library(R6)
library(ChainLadder)
library(janitor)
library(rowr)
library(knitr)
library(formattable)
library(kableExtra)
library(qpcR)
library(DT)
library(bit64)
library(flexdashboard)
library(stringr)
library(reshape2)
library(writexl)
library(res2ndopi)
library(lubridate)
 #This is a private library.  Run following installation command to install
#For Risk Management Department
#install.packages("P:/AXADJDivision/RiskManagement/05.Insurance?i????????????潟X?N?j/43.???U?[?r???O/R_package/res2ndopi",
#                 repos = NULL, type="source")
#For Sagara's local PC
#install.packages("C:/Users/S.Sagara/Documents/R/package_res_2nd_opinion/res2ndopi",
#                 repos = NULL, type="source")
```


```{r, include=FALSE}
# Manual update-------------------------------------------------------------------------------------------------------------------------------------------------------
mainDir <- "C:/Users/S.Sagara/AXA/ADJ - Risk Management - 保険引受リスク（P&C)/43.リザービング/2023/PCFY"
subDir_2 <- "01_Triangle_Data"

triangle_wd <- file.path(mainDir, subDir_2)
setwd(triangle_wd)

# Read Excel --------------------------------------------------------------

df <- read_excel("Triangle_Motor_202309.xlsx", sheet = "output_202309") 
df <- df %>%
  rename(
    CL_Large2 = CL_Large) # CL_Largeのヘッダー名をCL_Large2へ修正
df$Dev_Mths <- df['Dev_Mths'][[1]] + 1 #数理のデータがMotorだけDevMonthが０から始まっているから調整
df$CL_Large2[df$CL_Large2 == "Evente"] <- "Evented" #HY2020 数理データの"Evented"が"Evente"に変更されていたので対応処理

df_nonmotor <- read_excel("Triangle_NonMotor_202309.xlsx", sheet = "Data")
df_nonmotor$CL_Large2 <- "Attrit" #CL_Large2フィールドがNonMotorにはないので追加

df <- df[!(df$PRODUCTS=="BIKE" & df$COV_NAME=="PI" & df$CL_Large2=="Large" & df$YM_EV_OCC<=201207),] # イレギュラーなデータを削除
df_nonmotor <- df_nonmotor[!(df_nonmotor$YM_EV_OCC==200104),]

# ----------EP and Exposure-------------------------------
fst_auto_filename <- "01_IBNR_Auto_Linkout202309Finance_v3.xlsx"
fst_bike_filename <- "01_IBNR_Bike_Linkout202309Finance.xlsx"
fst_pet_filename <- "01_IBNR_Pet_new_Linkout202309Finance.xlsx"
fst_health_filename <- "01_IBNR_Health_new_Linkout202309Finance.xlsx"
# set up dates
origin_date <- data.frame(ORIGIN_DATE = seq(ymd(19990601), ymd(end_date), "months")) # old >> read_excel("origin_ym_199906_202104.xlsx")

#update manually every time
excl_rows2_input <- 309 #as of Sep 2023
excl_rows2_input_health_and_total <- 301 #as of Sep 2023


get_ep_exposure <- function(filename, sheetname, excl_row1, excl_row2, excl_row3, col_exp, col_ep, biz, prod, covname) {

  df <- read_excel(filename, sheet = sheetname)
  df <- df[-c(1:excl_row1, excl_row2:10000), c(col_exp, col_ep)]
  df <- cbind(origin_date, df)
  df$BIZ_LINE <- biz
  df$PRODUCTS <- prod
  df$COV_NAME <- covname
  colnames(df)[2] <- "EXPOSURE"
  colnames(df)[3] <-"EARNINGS"
  df$EXPOSURE <- as.numeric(df['EXPOSURE'][[1]])
  df$EARNINGS <- as.numeric(df['EARNINGS'][[1]])
  df <- df[, c(4,5,6,1,2,3)]
  return(df)

}


auto_bil <- get_ep_exposure(fst_auto_filename, sheetname="BIL_attr", excl_row1=16, excl_row2=excl_rows2_input, col_exp=9, col_ep=10, biz="Motor", prod="AUTO", covname="BIL")
auto_pdl <- get_ep_exposure(fst_auto_filename, sheetname="PDL_attr", excl_row1=16, excl_row2=excl_rows2_input, col_exp=9, col_ep=10, biz="Motor", prod="AUTO", covname="PDL")
auto_ppa <- get_ep_exposure(fst_auto_filename, sheetname="PPA_attr", excl_row1=16, excl_row2=excl_rows2_input, col_exp=9, col_ep=10, biz="Motor", prod="AUTO", covname="PPA")
auto_od <- get_ep_exposure(fst_auto_filename, sheetname="OD_attr", excl_row1=16, excl_row2=excl_rows2_input, col_exp=9, col_ep=10, biz="Motor", prod="AUTO", covname="OD")
auto_pe <- get_ep_exposure(fst_auto_filename, sheetname="PE_attr", excl_row1=16, excl_row2=excl_rows2_input, col_exp=9, col_ep=10, biz="Motor", prod="AUTO", covname="PE")
auto_pi <- get_ep_exposure(fst_auto_filename, sheetname="PI_attr", excl_row1=16, excl_row2=excl_rows2_input, col_exp=9, col_ep=10, biz="Motor", prod="AUTO", covname="PI")
auto_axap <- get_ep_exposure(fst_auto_filename, sheetname="AXA+_attr", excl_row1=16, excl_row2=excl_rows2_input, col_exp=9, col_ep=10, biz="Motor", prod="AUTO", covname="AXA+")
auto_fb <- get_ep_exposure(fst_auto_filename, sheetname="FB_attr", excl_row1=16, excl_row2=excl_rows2_input, col_exp=9, col_ep=10, biz="Motor", prod="AUTO", covname="FamilyBIKE")
auto_le <- get_ep_exposure(fst_auto_filename, sheetname="LX_attr", excl_row1=16, excl_row2=excl_rows2_input, col_exp=9, col_ep=10, biz="Motor", prod="AUTO", covname="LawyerE")
auto_eq <- get_ep_exposure(fst_auto_filename, sheetname="EQ_attr", excl_row1=16, excl_row2=excl_rows2_input, col_exp=9, col_ep=10, biz="Motor", prod="AUTO", covname="OD_EQ")[-c(1:164), ] #EQ special treatment

bike_bil <- get_ep_exposure(fst_bike_filename, sheetname="BIL_attr", excl_row1=16, excl_row2=excl_rows2_input, col_exp=9, col_ep=10, biz="Motor", prod="BIKE", covname="BIL")[-c(1:71), ]
bike_pdl <- get_ep_exposure(fst_bike_filename, sheetname="PDL_attr", excl_row1=16, excl_row2=excl_rows2_input, col_exp=9, col_ep=10, biz="Motor", prod="BIKE", covname="PDL")[-c(1:71), ]
bike_ppa <- get_ep_exposure(fst_bike_filename, sheetname="PPA_attr", excl_row1=16, excl_row2=excl_rows2_input, col_exp=9, col_ep=10, biz="Motor", prod="BIKE", covname="PPA")[-c(1:71), ]
bike_pi <- get_ep_exposure(fst_bike_filename, sheetname="PI_attr", excl_row1=16, excl_row2=excl_rows2_input, col_exp=9, col_ep=10, biz="Motor", prod="BIKE", covname="PI")[-c(1:71), ]
bike_le <- get_ep_exposure(fst_bike_filename, sheetname="LX_attr", excl_row1=16, excl_row2=excl_rows2_input, col_exp=9, col_ep=10, biz="Motor", prod="BIKE", covname="LawyerE")[-c(1:71), ]

# PAの数理ファイルのフォーマット変更に対応 202103
pa_total <- get_ep_exposure(fst_health_filename, sheetname="PA_TOTAL", excl_row1=8, excl_row2=excl_rows2_input_health_and_total, col_exp=5, col_ep=6, biz="PA", prod="PA", covname="Total")[-c(1:23), ]
pet_total <- get_ep_exposure(fst_pet_filename, sheetname="PET", excl_row1=16, excl_row2=excl_rows2_input, col_exp=9, col_ep=10, biz="PET", prod="PET", covname="Total")[-c(1:127), ]

# end of manual input ----------------------------------

df_exp_ep <- rbind(
  auto_bil,
  auto_pdl,
  auto_ppa,
  auto_od,
  auto_pe,
  auto_pi,
  auto_axap,
  auto_fb,
  auto_le,
  auto_eq,
  bike_bil,
  bike_pdl,
  bike_ppa,
  bike_pi,
  bike_le,
  pa_total,
  pet_total
)

df_exp_ep$PRODUCTS[df_exp_ep$PRODUCTS == "AUTO"] <- "Auto"
df_exp_ep[is.na(df_exp_ep['EXPOSURE']), 'EXPOSURE'] <- 0
df_exp_ep[is.na(df_exp_ep['EARNINGS']), 'EARNINGS'] <- 0


#----------------------------------

df_motor <- df %>%
  group_by(BIZ_LINE, YM_EV_OCC, Dev_Mths) %>%
  summarise(paid=sum(paid), os=sum(os), inc=sum(inc), claims=sum(claims)) %>%
  mutate(PRODUCTS = "Motor", COV_NAME = "Total", CL_Large2="Total")


#Summary for total coverage Motor
df_total <- df %>%
  group_by(BIZ_LINE, PRODUCTS, COV_NAME, YM_EV_OCC, Dev_Mths) %>%
  summarise(paid=sum(paid), os=sum(os), inc=sum(inc), claims=sum(claims)) %>%
  mutate(CL_Large2="Total")
#ODPEを抽出
df_odpe <- df %>%
  filter(COV_NAME == "OD" | COV_NAME == "PE") %>%
  group_by(BIZ_LINE, PRODUCTS, CL_Large2, YM_EV_OCC, Dev_Mths) %>%
  summarise(paid=sum(paid), os=sum(os), inc=sum(inc), claims=sum(claims)) %>%
  mutate(COV_NAME="ODPE")
#BI, PIはLargeとSmallに分けるのでデータを分けて持つ
df_bi_pi <- df %>%
  filter(COV_NAME == "BIL" | COV_NAME == "PI")

#Non Motor
#NonMotor Totalを集計 coverage totalが必要 すべてAttrit
df_nm_total <- df_nonmotor %>%
  group_by(BIZ_LINE, CL_Large2, YM_EV_OCC, Dev_Mths) %>%
  summarise(paid=sum(paid), os=sum(os), inc=sum(inc), claims=sum(claims)) %>%
  mutate(PRODUCTS = "Total", COV_NAME="Total")
#PA Total
df_pa_total <- df_nonmotor %>%
  filter(BIZ_LINE=="PA") %>%
  group_by(BIZ_LINE, CL_Large2, YM_EV_OCC, Dev_Mths) %>%
  summarise(paid=sum(paid), os=sum(os), inc=sum(inc), claims=sum(claims)) %>%
  mutate(PRODUCTS = "PA", COV_NAME="Total")
#Pet Total
df_pet_total <- df_nonmotor %>%
  filter(BIZ_LINE=="PET") %>%
  group_by(BIZ_LINE, CL_Large2, YM_EV_OCC, Dev_Mths) %>%
  summarise(paid=sum(paid), os=sum(os), inc=sum(inc), claims=sum(claims)) %>%
  mutate(PRODUCTS = "PET", COV_NAME="Total")
#Death+Disabilityを抽出
df_nm_dd <- df_nonmotor %>%
  filter(COV_NAME == "DEATH" | COV_NAME == "DISBL") %>%
  group_by(BIZ_LINE, CL_Large2, YM_EV_OCC, Dev_Mths) %>%
  summarise(paid=sum(paid), os=sum(os), inc=sum(inc), claims=sum(claims)) %>%
  mutate(COV_NAME="DTH_DISBL", PRODUCTS="PA")
#PA other を抽出
df_nm_oth <- df_nonmotor %>%
  filter(BIZ_LINE == "PA" & (COV_NAME != "DEATH" & COV_NAME != "DISBL")) %>%
  group_by(BIZ_LINE, CL_Large2, YM_EV_OCC, Dev_Mths) %>%
  summarise(paid=sum(paid), os=sum(os), inc=sum(inc), claims=sum(claims)) %>%
  mutate(COV_NAME="PA_OTH", PRODUCTS="PA")
#Combine all
#df_with_total <- as.data.frame(bind_rows(df_total, df_odpe, df_bi_pi, df_pa_total, df_pet_total))
df_with_total <- as.data.frame(bind_rows(df_total, df_odpe, df_motor, df_bi_pi, df_pa_total, df_pet_total))
#Nest
df_for_tri <- df_with_total %>%
  group_by(BIZ_LINE, PRODUCTS, COV_NAME, CL_Large2) %>%
  nest()



# Exposure, EP ------------------------------------------------------------

#ODPEを抽出
df_exp_ep2 <- df_exp_ep %>%
  separate(ORIGIN_DATE, sep = "-", into= c("year", "month", "day")) %>%
  mutate(ym=paste(year, month, sep = "")) %>%
  dplyr::select(BIZ_LINE, PRODUCTS, COV_NAME, ym, EXPOSURE, EARNINGS)
df_odpe_exp <- df_exp_ep2 %>%
  filter(COV_NAME == "OD" | COV_NAME == "PE") %>%
  group_by(BIZ_LINE, PRODUCTS, ym) %>%
  summarise(EXPOSURE=sum(EXPOSURE)/2, EARNINGS=sum(EARNINGS)) %>%
  mutate(COV_NAME="ODPE")
#PA
df_pa_exp <- df_exp_ep2 %>%
  filter(BIZ_LINE=="PA" & COV_NAME=="Total") %>%
  group_by(BIZ_LINE, ym) %>%
  summarise(EXPOSURE=sum(EXPOSURE), EARNINGS=sum(EARNINGS)) %>%
  mutate(PRODUCTS="PA", COV_NAME="Total")

# Motor
df_motor_exp <- df_exp_ep2 %>%
  filter(BIZ_LINE=="Motor") %>%
  group_by(BIZ_LINE, ym) %>%
  summarise(EXPOSURE=sum(EXPOSURE), EARNINGS=sum(EARNINGS)) %>%
  mutate(PRODUCTS="Motor", COV_NAME="Total")

#Combine all exp ep
#df_exp_ep2 <- bind_rows(df_exp_ep2, df_odpe_exp, df_pa_exp)
df_exp_ep2 <- bind_rows(df_exp_ep2, df_odpe_exp, df_motor_exp, df_pa_exp)
#Nest
df_exp_ep_nest <- df_exp_ep2 %>%
  as.data.frame() %>%  mutate(ym = as.numeric(ym)) %>%
  group_by(BIZ_LINE, PRODUCTS, COV_NAME) %>%
  nest()
#exhibit preparation

df_exp_ep_nest <- df_exp_ep_nest %>%
  mutate(
    cont_exhibit = data %>% map(cont_exhibit)
  )

# Merge Claim and Exposure and EP -----------------------------------------

#Add key to claim
df_for_tri$key <- paste(df_for_tri$PRODUCTS, df_for_tri$COV_NAME)
#add key to cont
df_exp_ep_nest$key <- paste(df_exp_ep_nest$PRODUCTS, df_exp_ep_nest$COV_NAME)
df_exp_ep_nest <- df_exp_ep_nest %>%
  ungroup() %>% #added 20200601 seems new dplyr logic
  dplyr::select(data, cont_exhibit, key)

#Merge
df_claim_cont <- merge(x=df_for_tri, y=df_exp_ep_nest, by="key") %>%
  dplyr::select(-key) %>%
  dplyr::rename(data=data.x)


# Prepare reserving data --------------------------------------------------

Reserve_Data <- df_claim_cont %>%
  mutate(
    inc_tri   = data %>% map(make_inc_tri),
    paid_tri  = data %>% map(make_paid_tri),
    os_tri    = data %>% map(make_os_tri),
    clcnt_tri = data %>% map(make_clcnt_tri),
    lkr_tri   = inc_tri %>% map(make_lkr_tri),
    mthly_inc = inc_tri %>% map(get_mthly_inc),
    #linkratio without adjustment
    lkr_smpl = inc_tri %>% map(lkr_smpl_avg),
    lkr_vwtd = inc_tri %>% map(lkr_vwtd),
    lkr_excl_beg = map2(inc_tri, 10, lkr_vwtd_excl_beg),
    lkr12 = inc_tri %>% map(lkr_ex_maxmin12),
    lkr24 = inc_tri %>% map(lkr_ex_maxmin24),
    lkr36 = inc_tri %>% map(lkr_ex_maxmin36),
    lkr3 = inc_tri %>% map(lkr_ex_maxmin3),
    lkr5 = inc_tri %>% map(lkr_ex_maxmin5),
    lkr7 = inc_tri %>% map(lkr_ex_maxmin7),
    lkr_clcnt_smpl = clcnt_tri %>% map(lkr_smpl_avg),
    #linkratio with adjustment
    lkr_smpl_adj = map(lkr_smpl, lkr_adjust),
    lkr_vwtd_adj = map(lkr_vwtd, lkr_adjust),
    lkr_excl_beg_adj = map(lkr_excl_beg, lkr_adjust),
    lkr12_adj = map(lkr12, lkr_adjust),
    lkr24_adj = map(lkr24, lkr_adjust),
    lkr36_adj = map(lkr36, lkr_adjust),
    lkr3_adj = map(lkr3, lkr_adjust),
    lkr5_adj = map(lkr5, lkr_adjust),
    lkr7_adj = map(lkr7, lkr_adjust),
    #linkratio cumulated
    lkr_smpl_cum = lkr_smpl %>% map(lkr_cumulate),
    lkr_vwtd_cum = lkr_vwtd %>% map(lkr_cumulate),
    lkr12_cum = lkr12 %>% map(lkr_cumulate),
    lkr24_cum = lkr24 %>% map(lkr_cumulate),
    lkr36_cum = lkr36 %>% map(lkr_cumulate),
    lkr3_cum = lkr3 %>% map(lkr_cumulate),
    lkr5_cum = lkr5 %>% map(lkr_cumulate),
    lkr7_cum = lkr7 %>% map(lkr_cumulate),
    lkr_clcnt_smpl_cum = lkr_clcnt_smpl %>% map(lkr_cumulate),

    lkr_smpl_adj_cum = lkr_smpl_adj %>% map(lkr_cumulate),
    lkr_vwtd_adj_cum = lkr_vwtd_adj %>% map(lkr_cumulate),
    lkr12_adj_cum = lkr12_adj %>% map(lkr_cumulate),
    lkr24_adj_cum = lkr24_adj %>% map(lkr_cumulate),
    lkr36_adj_cum = lkr36_adj %>% map(lkr_cumulate),
    lkr3_adj_cum = lkr3_adj %>% map(lkr_cumulate),
    lkr5_adj_cum = lkr5_adj %>% map(lkr_cumulate),
    lkr7_adj_cum = lkr7_adj %>% map(lkr_cumulate),
    #Exhibits
    exhibit_smpl = pmap(list(inc_tri, paid_tri, os_tri, clcnt_tri, lkr_smpl_cum, lkr_clcnt_smpl_cum, cont_exhibit), make_exhibit),
    exhibit_vwtd = pmap(list(inc_tri, paid_tri, os_tri, clcnt_tri, lkr_vwtd_cum, lkr_clcnt_smpl_cum, cont_exhibit), make_exhibit),
    exhibit3 = pmap(list(inc_tri, paid_tri, os_tri, clcnt_tri, lkr3_cum, lkr_clcnt_smpl_cum, cont_exhibit), make_exhibit),
    exhibit5 = pmap(list(inc_tri, paid_tri, os_tri, clcnt_tri, lkr5_cum, lkr_clcnt_smpl_cum, cont_exhibit), make_exhibit),
    exhibit7 = pmap(list(inc_tri, paid_tri, os_tri, clcnt_tri, lkr7_cum, lkr_clcnt_smpl_cum, cont_exhibit), make_exhibit),
    exhibit12 = pmap(list(inc_tri, paid_tri, os_tri, clcnt_tri, lkr12_cum, lkr_clcnt_smpl_cum, cont_exhibit), make_exhibit),
    exhibit24 = pmap(list(inc_tri, paid_tri, os_tri, clcnt_tri, lkr24_cum, lkr_clcnt_smpl_cum, cont_exhibit), make_exhibit),
    exhibit36 = pmap(list(inc_tri, paid_tri, os_tri, clcnt_tri, lkr36_cum, lkr_clcnt_smpl_cum, cont_exhibit), make_exhibit),


    exhibit_smpl_adj = pmap(list(inc_tri, paid_tri, os_tri, clcnt_tri, lkr_smpl_adj_cum, lkr_clcnt_smpl_cum, cont_exhibit), make_exhibit),
    exhibit_vwtd_adj = pmap(list(inc_tri, paid_tri, os_tri, clcnt_tri, lkr_vwtd_adj_cum, lkr_clcnt_smpl_cum, cont_exhibit), make_exhibit),
    exhibit3_adj = pmap(list(inc_tri, paid_tri, os_tri, clcnt_tri, lkr3_adj_cum, lkr_clcnt_smpl_cum, cont_exhibit), make_exhibit),
    exhibit5_adj = pmap(list(inc_tri, paid_tri, os_tri, clcnt_tri, lkr5_adj_cum, lkr_clcnt_smpl_cum, cont_exhibit), make_exhibit),
    exhibit7_adj = pmap(list(inc_tri, paid_tri, os_tri, clcnt_tri, lkr7_adj_cum, lkr_clcnt_smpl_cum, cont_exhibit), make_exhibit),
    exhibit12_adj = pmap(list(inc_tri, paid_tri, os_tri, clcnt_tri, lkr12_adj_cum, lkr_clcnt_smpl_cum, cont_exhibit), make_exhibit),
    exhibit24_adj = pmap(list(inc_tri, paid_tri, os_tri, clcnt_tri, lkr24_adj_cum, lkr_clcnt_smpl_cum, cont_exhibit), make_exhibit),
    exhibit36_adj = pmap(list(inc_tri, paid_tri, os_tri, clcnt_tri, lkr36_adj_cum, lkr_clcnt_smpl_cum, cont_exhibit), make_exhibit),


    #Plot lkr
    #lkr_plot = map2(inc_tri, lkr_tri, plot_lkr),
    #monthly eaxa
    mthly_eaxa12 = map2(mthly_inc, lkr12_cum, get_mthly_eaxa)

  )

# Projection --------------------------------------------------------------


# Plot and Exhibit ----------------------------------------------------------------

eaxa_res_by_model <- Reserve_Data %>%
  unnest(exhibit_vwtd, exhibit3, exhibit5, exhibit7, exhibit12, exhibit24, exhibit36, exhibit_vwtd_adj, exhibit3_adj, exhibit5_adj, exhibit7_adj, exhibit12_adj, exhibit24_adj, exhibit36_adj) %>%
  dplyr::filter(AY == "CY_Total" | AY == "PY_Total" | AY == "Total") %>%
  dplyr::filter(PRODUCTS == "Auto" | PRODUCTS =="BIKE" | PRODUCTS =="PA" | PRODUCTS == "PET") %>%
  dplyr::select(BIZ_LINE, PRODUCTS, COV_NAME, CL_Large2, AY, starts_with("EAXA_RES")) %>%
  dplyr::rename(M01_vwtd = EAXA_RES, M02_emm3 = EAXA_RES1, M03_emm5 = EAXA_RES2, M04_emm7 = EAXA_RES3, M05_emm12 = EAXA_RES4, M06_emm24 = EAXA_RES5, M07_emm36 = EAXA_RES6,
                M08_vwtd_adj = EAXA_RES7, M09_emm3_adj = EAXA_RES8, M10_emm5_adj = EAXA_RES9, M11_emm7_adj = EAXA_RES10, M12_emm12_adj = EAXA_RES11, M13_emm24_adj = EAXA_RES12, M14_emm36_adj = EAXA_RES13) %>%
  tidyr::gather(key = Model, value = EAXA_Res, M01_vwtd, M02_emm3, M03_emm5, M04_emm7, M05_emm12, M06_emm24, M07_emm36, M08_vwtd_adj, M09_emm3_adj, M10_emm5_adj, M11_emm7_adj, M12_emm12_adj, M13_emm24_adj, M14_emm36_adj)

eaxa_res_plot_all <- ggplot(eaxa_res_by_model,
                            aes(x = AY, y = EAXA_Res/10^6, fill = Model)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap( ~ PRODUCTS+COV_NAME+CL_Large2, scales = "free") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  scale_y_continuous(name="EAXA Reserve (mJPY)", labels = scales::comma)
#
#
#Auto BIL Small
product <- "Auto"
cov <- "BIL"
cl_type <- "Attrit"
mdl_type <- "exhibit36" # PCFY20 no chnage
lkr_type <- "lkr36"
tri_begin_ym <- "199909"
auto_bil_sc_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_bil_sc_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
auto_bil_sc_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type) # keep emm36 HY20
auto_bil_sc_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_bil_sc_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_bil_sc_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_bil_sc_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_bil_sc_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_bil_sc_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_bil_sc_ac_tri <- cbind(auto_bil_sc_tri[, 1], auto_bil_sc_fulltri[, -1] / auto_bil_sc_clcnt_fulltri[, -1])
auto_bil_sc_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = auto_bil_sc_clcnt_fulltri)
auto_bil_sc_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = auto_bil_sc_fulltri)
auto_bil_sc_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = auto_bil_sc_fulltri)
auto_bil_sc_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)


#Auto BIL Large
product <- "Auto"
cov <- "BIL"
cl_type <- "Large"
mdl_type <- "exhibit36" # PCFY20 24, HY21 FC1 36へ変更必要か
lkr_type <- "lkr36"
tri_begin_ym <- "200101"
auto_bil_lc_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_bil_lc_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
auto_bil_lc_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type) #mod emm7 to emm36
auto_bil_lc_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_bil_lc_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_bil_lc_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_bil_lc_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_bil_lc_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_bil_lc_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_bil_lc_ac_tri <- cbind(auto_bil_lc_tri[, 1], auto_bil_lc_fulltri[, -1] / auto_bil_lc_clcnt_fulltri[, -1])
auto_bil_lc_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = auto_bil_lc_clcnt_fulltri)
auto_bil_lc_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = auto_bil_lc_fulltri)
auto_bil_lc_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = auto_bil_lc_fulltri)
auto_bil_lc_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)


#Auto PDL
product <- "Auto"
cov <- "PDL"
cl_type <- "Total"
mdl_type <- "exhibit12" # PCFY20 no chnage
lkr_type <- "lkr12"
tri_begin_ym <- "199908"
auto_pdl_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_pdl_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
auto_pdl_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
auto_pdl_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_pdl_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_pdl_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_pdl_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_pdl_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_pdl_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_pdl_ac_tri <- cbind(auto_pdl_tri[, 1], auto_pdl_fulltri[, -1] / auto_pdl_clcnt_fulltri[, -1])
auto_pdl_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = auto_pdl_clcnt_fulltri)
auto_pdl_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = auto_pdl_fulltri)
auto_pdl_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = auto_pdl_fulltri)
auto_pdl_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)

#Auto PI Small
product <- "Auto"
cov <- "PI"
cl_type <- "Attrit"
mdl_type <- "exhibit12_adj" # HY21 12から36を検討 
lkr_type <- "lkr12_adj"
tri_begin_ym <- "200104"
auto_pi_sc_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_pi_sc_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
auto_pi_sc_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
auto_pi_sc_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)  # keep emm12 HY20
auto_pi_sc_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_pi_sc_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_pi_sc_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_pi_sc_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_pi_sc_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_pi_sc_ac_tri <- cbind(auto_pi_sc_tri[, 1], auto_pi_sc_fulltri[, -1] / auto_pi_sc_clcnt_fulltri[, -1])
auto_pi_sc_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = auto_pi_sc_clcnt_fulltri)
auto_pi_sc_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = auto_pi_sc_fulltri)
auto_pi_sc_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = auto_pi_sc_fulltri)
auto_pi_sc_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)

#Auto PI Large
product <- "Auto"
cov <- "PI"
cl_type <- "Large"
mdl_type <- "exhibit12" # PCFY20 no chnage
lkr_type <- "lkr12"
tri_begin_ym <- "200205"
auto_pi_lc_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_pi_lc_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
auto_pi_lc_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
auto_pi_lc_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_pi_lc_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_pi_lc_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_pi_lc_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_pi_lc_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_pi_lc_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_pi_lc_ac_tri <- cbind(auto_pi_lc_tri[, 1], auto_pi_lc_fulltri[, -1] / auto_pi_lc_clcnt_fulltri[, -1])
auto_pi_lc_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = auto_pi_lc_clcnt_fulltri)
auto_pi_lc_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = auto_pi_lc_fulltri)
auto_pi_lc_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = auto_pi_lc_fulltri)
auto_pi_lc_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)

#Auto PPA
product <- "Auto"
cov <- "PPA"
cl_type <- "Total"
mdl_type <- "exhibit12" # PCFY20 no chnage
lkr_type <- "lkr12"
tri_begin_ym <- "199909"
auto_ppa_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_ppa_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
auto_ppa_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
auto_ppa_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_ppa_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_ppa_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_ppa_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_ppa_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_ppa_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_ppa_ac_tri <- cbind(auto_ppa_tri[, 1], auto_ppa_fulltri[, -1] / auto_ppa_clcnt_fulltri[, -1])
auto_ppa_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = auto_ppa_clcnt_fulltri)
auto_ppa_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = auto_ppa_fulltri)
auto_ppa_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = auto_ppa_fulltri)
auto_ppa_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)

#Auto ODPE
product <- "Auto"
cov <- "ODPE"
cl_type <- "Attrit"
mdl_type <- "exhibit7" # PCFY20 no chnage
lkr_type <- "lkr7"
tri_begin_ym <- "199908"
auto_odpe_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_odpe_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
auto_odpe_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
auto_odpe_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)  #mod emm12 to emm7 HY20
auto_odpe_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_odpe_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_odpe_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_odpe_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_odpe_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_odpe_ac_tri <- cbind(auto_odpe_tri[, 1], auto_odpe_fulltri[, -1] / auto_odpe_clcnt_fulltri[, -1])
auto_odpe_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = auto_odpe_clcnt_fulltri)
auto_odpe_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = auto_odpe_fulltri)
auto_odpe_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = auto_odpe_fulltri)
auto_odpe_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)

#Auto ODPE Event
product <- "Auto"
cov <- "ODPE"
cl_type <- "Evented"
mdl_type <- "exhibit12"  # PCFY20 no chnage
lkr_type <- "lkr12"
tri_begin_ym <- "200707"
auto_odpe_ev_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_odpe_ev_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
auto_odpe_ev_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
auto_odpe_ev_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)  # keep emm12 HY20
auto_odpe_ev_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_odpe_ev_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_odpe_ev_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_odpe_ev_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_odpe_ev_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_odpe_ev_ac_tri <- cbind(auto_odpe_ev_tri[, 1], auto_odpe_ev_fulltri[, -1] / auto_odpe_ev_clcnt_fulltri[, -1])
auto_odpe_ev_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = auto_odpe_ev_clcnt_fulltri)
auto_odpe_ev_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = auto_odpe_ev_fulltri)
auto_odpe_ev_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = auto_odpe_ev_fulltri)
auto_odpe_ev_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)

#Auto LE
product <- "Auto"
cov <- "LawyerE"
cl_type <- "Total"
mdl_type <- "exhibit36_adj" # PCFY20 24 HY21 FC1 36とするがまだ少ないか
lkr_type <- "lkr36_adj"
tri_begin_ym <- "200309"
auto_le_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_le_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
auto_le_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
auto_le_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)  #mod emm12 to emm24
auto_le_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_le_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_le_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_le_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_le_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_le_ac_tri <- cbind(auto_le_tri[, 1], auto_le_fulltri[, -1] / auto_le_clcnt_fulltri[, -1])
auto_le_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = auto_le_clcnt_fulltri)
auto_le_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = auto_le_fulltri)
auto_le_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = auto_le_fulltri)
auto_le_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)

#Auto FB
product <- "Auto"
cov <- "FamilyBIKE"
cl_type <- "Total"
mdl_type <- "exhibit36" # PCFY20 12
lkr_type <- "lkr36"
tri_begin_ym <- "200305"
auto_fb_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_fb_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
auto_fb_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
auto_fb_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_fb_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_fb_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_fb_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_fb_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_fb_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_fb_ac_tri <- cbind(auto_fb_tri[, 1], auto_fb_fulltri[, -1] / auto_fb_clcnt_fulltri[, -1])
auto_fb_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = auto_fb_clcnt_fulltri)
auto_fb_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = auto_fb_fulltri)
auto_fb_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = auto_fb_fulltri)
auto_fb_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)

#Auto AXAP
product <- "Auto"
cov <- "AXA+"
cl_type <- "Total"
mdl_type <- "exhibit12" # HY21 12
lkr_type <- "lkr12"
tri_begin_ym <- "200501"
auto_axap_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_axap_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
auto_axap_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
auto_axap_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_axap_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_axap_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_axap_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_axap_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_axap_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_axap_ac_tri <- cbind(auto_axap_tri[, 1], auto_axap_fulltri[, -1] / auto_axap_clcnt_fulltri[, -1])
auto_axap_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = auto_axap_clcnt_fulltri)
auto_axap_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = auto_axap_fulltri)
auto_axap_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = auto_axap_fulltri)
auto_axap_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)

#Auto EQ
product <- "Auto"
cov <- "OD_EQ"
cl_type <- "Total"
mdl_type <- "exhibit12" # PCFY20 no chnage
lkr_type <- "lkr12"
tri_begin_ym <- "201604"
auto_eq_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_eq_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
auto_eq_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
auto_eq_exhibit <- eaxa_exhibit(c("1999", "2000", "2001", "2002", "2003", "2004", "2005", "2006",
                                  "2007", "2008", "2009", "2010", "2011", "2012"), auto_eq_exhibit)
auto_eq_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_eq_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_eq_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_eq_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_eq_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
auto_eq_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
auto_eq_ac_tri <- cbind(auto_eq_tri[, 1], auto_eq_fulltri[, -1] / auto_eq_clcnt_fulltri[, -1])
auto_eq_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = auto_eq_clcnt_fulltri)
auto_eq_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = auto_eq_fulltri)
auto_eq_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = auto_eq_fulltri)
auto_eq_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)

#Bike BIL Small
product <- "BIKE"
cov <- "BIL"
cl_type <- "Attrit"
mdl_type <- "exhibit12_adj" # 
lkr_type <- "lkr12_adj"
tri_begin_ym <- "200505"
bike_bil_sc_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_bil_sc_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
bike_bil_sc_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
bike_bil_sc_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
bike_bil_sc_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_bil_sc_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_bil_sc_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_bil_sc_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_bil_sc_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
bike_bil_sc_ac_tri <- cbind(bike_bil_sc_tri[, 1], bike_bil_sc_fulltri[, -1] / bike_bil_sc_clcnt_fulltri[, -1])
bike_bil_sc_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = bike_bil_sc_clcnt_fulltri)
bike_bil_sc_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = bike_bil_sc_fulltri)
bike_bil_sc_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = bike_bil_sc_fulltri)
bike_bil_sc_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)

#Bike BIL Large
product <- "BIKE"
cov <- "BIL"
cl_type <- "Large"
mdl_type <- "exhibit_vwtd_adj" # PCFY20 36
lkr_type <- "lkr_vwtd_adj"
tri_begin_ym <- "200612"
bike_bil_lc_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_bil_lc_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
bike_bil_lc_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
bike_bil_lc_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
bike_bil_lc_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_bil_lc_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_bil_lc_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_bil_lc_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_bil_lc_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
bike_bil_lc_ac_tri <- cbind(bike_bil_lc_tri[, 1], bike_bil_lc_fulltri[, -1] / bike_bil_lc_clcnt_fulltri[, -1])
bike_bil_lc_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = bike_bil_lc_clcnt_fulltri)
bike_bil_lc_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = bike_bil_lc_fulltri)
bike_bil_lc_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = bike_bil_lc_fulltri)
bike_bil_lc_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)

#Bike PDL
product <- "BIKE"
cov <- "PDL"
cl_type <- "Total"
mdl_type <- "exhibit12" # PCFY20 no chnage
lkr_type <- "lkr12"
tri_begin_ym <- "200505"
bike_pdl_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_pdl_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
bike_pdl_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
bike_pdl_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
bike_pdl_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_pdl_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_pdl_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_pdl_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_pdl_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
bike_pdl_ac_tri <- cbind(bike_pdl_tri[, 1], bike_pdl_fulltri[, -1] / bike_pdl_clcnt_fulltri[, -1])
bike_pdl_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = bike_pdl_clcnt_fulltri)
bike_pdl_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = bike_pdl_fulltri)
bike_pdl_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = bike_pdl_fulltri)
bike_pdl_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)

#Bike PI Small
product <- "BIKE"
cov <- "PI"
cl_type <- "Attrit"
mdl_type <- "exhibit24" # HY21 emm24に変更
lkr_type <- "lkr24"
tri_begin_ym <- "200811"
bike_pi_sc_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_pi_sc_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
bike_pi_sc_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
bike_pi_sc_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
bike_pi_sc_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_pi_sc_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_pi_sc_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_pi_sc_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_pi_sc_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_pi_sc_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
bike_pi_sc_ac_tri <- cbind(bike_pi_sc_tri[, 1], bike_pi_sc_fulltri[, -1] / bike_pi_sc_clcnt_fulltri[, -1])
bike_pi_sc_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = bike_pi_sc_clcnt_fulltri)
bike_pi_sc_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = bike_pi_sc_fulltri)
bike_pi_sc_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = bike_pi_sc_fulltri)
bike_pi_sc_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)

#Bike PI Large
product <- "BIKE"
cov <- "PI"
cl_type <- "Large"
mdl_type <- "exhibit_vwtd_adj" # PCFY20 12
lkr_type <- "lkr_vwtd_adj"
tri_begin_ym <- "201306" # mod 202103
bike_pi_lc_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_pi_lc_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
bike_pi_lc_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
bike_pi_lc_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
bike_pi_lc_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_pi_lc_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_pi_lc_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_pi_lc_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_pi_lc_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
bike_pi_lc_ac_tri <- cbind(bike_pi_lc_tri[, 1], bike_pi_lc_fulltri[, -1] / bike_pi_lc_clcnt_fulltri[, -1])
bike_pi_lc_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = bike_pi_lc_clcnt_fulltri)
bike_pi_lc_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = bike_pi_lc_fulltri)
bike_pi_lc_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = bike_pi_lc_fulltri)
bike_pi_lc_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)

#Bike PPA
product <- "BIKE"
cov <- "PPA"
cl_type <- "Total"
mdl_type <- "exhibit36" # PCFY20 12
lkr_type <- "lkr36"
tri_begin_ym <- "200505"
bike_ppa_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_ppa_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
bike_ppa_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
bike_ppa_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
bike_ppa_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_ppa_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_ppa_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_ppa_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_ppa_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
bike_ppa_ac_tri <- cbind(bike_ppa_tri[, 1], bike_ppa_fulltri[, -1] / bike_ppa_clcnt_fulltri[, -1])
bike_ppa_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = bike_ppa_clcnt_fulltri)
bike_ppa_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = bike_ppa_fulltri)
bike_ppa_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = bike_ppa_fulltri)
bike_ppa_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)

#Bike LE
product <- "BIKE"
cov <- "LawyerE"
cl_type <- "Total"
mdl_type <- "exhibit36" #PCFY 12
lkr_type <- "lkr36"
tri_begin_ym <- "200507"
bike_le_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_le_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
bike_le_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
bike_le_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
bike_le_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_le_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_le_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_le_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
bike_le_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
bike_le_ac_tri <- cbind(bike_le_tri[, 1], bike_le_fulltri[, -1] / bike_le_clcnt_fulltri[, -1])
bike_le_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = bike_le_clcnt_fulltri)
bike_le_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = bike_le_fulltri)
bike_le_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = bike_le_fulltri)
bike_le_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)

#PA
product <- "PA"
cov <- "Total"
cl_type <- "Attrit"
mdl_type <- "exhibit36" # PCFY20 no chnage
lkr_type <- "lkr36"
tri_begin_ym <- "200105"
pa_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
pa_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
pa_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
pa_exhibit <- eaxa_exhibit(c("1999", "2000"), pa_exhibit)
pa_exhibit <- format_exhibit(pa_exhibit)
pa_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
pa_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
pa_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
pa_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
pa_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
pa_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
pa_ac_tri <- cbind(pa_tri[, 1], pa_fulltri[, -1] / pa_clcnt_fulltri[, -1])
pa_freq_tri <- make_freq_tri(begin_ym = tri_begin_ym, clcnt_tri = pa_clcnt_fulltri)
pa_lr_tri <- make_lr_full_tri(begin_ym = tri_begin_ym, full_tri = pa_fulltri)
pa_bc_tri <- make_bc_tri(begin_ym = tri_begin_ym, inc_tri = pa_fulltri)
pa_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)

#Pet
product <- "PET"
cov <- "Total"
cl_type <- "Attrit"
mdl_type <- "exhibit12" # PCFY20 no chnage
lkr_type <- "lkr12"
tri_begin_ym <- "200604"
pet_ldf_plot <- Reserve_Data$lkr_plot[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
pet_er_models_plot <- Eaxa_res_plot_by_model(eaxa_res_by_model, product = product, cov = cov, cl_type = cl_type)
pet_exhibit <- exhibit_by_cov(mdl_type, product = product, cov = cov, cl_type = cl_type)
pet_exhibit <- eaxa_exhibit(c("1999", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2008", "2009"), pet_exhibit)
pet_exhibit <- format_exhibit(pet_exhibit)
pet_fulltri <- get_full_triangle(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
pet_lkr <- Reserve_Data[, lkr_type][Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
pet_tri <- Reserve_Data$inc_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
pet_lkr_tri <- Reserve_Data$lkr_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
pet_clcnt_tri <- Reserve_Data$clcnt_tri[Reserve_Data$PRODUCTS==product & Reserve_Data$COV_NAME==cov & Reserve_Data$CL_Large2==cl_type][[1]]
pet_clcnt_fulltri <- get_full_triangle_clcnt(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
pet_ac_tri <- cbind(pet_tri[, 1], pet_fulltri[, -1] / pet_clcnt_fulltri[, -1])
pet_freq_tri <- make_freq_tri_pet(begin_ym = tri_begin_ym, clcnt_tri = pet_clcnt_fulltri) # *Pet specific function
pet_lr_tri <- make_lr_full_tri_pet(begin_ym = tri_begin_ym, full_tri = pet_fulltri) # *Pet specific function
pet_bc_tri <- make_bc_tri_pet(begin_ym = tri_begin_ym, inc_tri = pet_fulltri) # *Pet specific function
pet_fulltri_paid <- get_full_triangle_paid(lkr_type = lkr_type, product = product, cov = cov, cl_type = cl_type)
#
# End of Projection section ----------------------------------------------------
#
# Aggregate --------------------------------------------------------------------

#Auto BIL
auto_bil_exhibit <- add_sc_lc(auto_bil_sc_exhibit, auto_bil_lc_exhibit)

#Auto PI
auto_pi_exhibit <- add_sc_lc(auto_pi_sc_exhibit, auto_pi_lc_exhibit)

#Auto ODPE Total
auto_od_pe_ev_exhibit <- add_sc_lc(auto_odpe_exhibit, auto_odpe_ev_exhibit)

#Auto Total
drops <- c("AY", "EXPOSURE", "FF_LR", "EAXA_LR", "FREQ", "AVG_COST", "AVG_EP", "EAXA_FREQ", "EAXA_AVG_COST")
auto_exhibit <- cbind(
  AY=auto_bil_exhibit[, "AY"],
  (
    auto_bil_exhibit[, !(names(auto_bil_exhibit) %in% drops)] +
      auto_pi_exhibit[, !(names(auto_pi_exhibit) %in% drops)] +
      auto_pdl_exhibit[, !(names(auto_pdl_exhibit) %in% drops)] +
      auto_ppa_exhibit[, !(names(auto_ppa_exhibit) %in% drops)] +
      auto_od_pe_ev_exhibit[, !(names(auto_od_pe_ev_exhibit) %in% drops)] +
      auto_fb_exhibit[, !(names(auto_fb_exhibit) %in% drops)] +
      auto_le_exhibit[, !(names(auto_le_exhibit) %in% drops)] +
      auto_axap_exhibit[, !(names(auto_axap_exhibit) %in% drops)] +
      auto_eq_exhibit[, !(names(auto_eq_exhibit) %in% drops)]
  ),
  EXPOSURE = auto_bil_exhibit$EXPOSURE)
auto_exhibit <- stats_func(auto_exhibit)
auto_exhibit <- format_exhibit(auto_exhibit)

#Bike###

#Bike BIL
bike_bil_exhibit <- add_sc_lc(bike_bil_sc_exhibit, bike_bil_lc_exhibit)

#Bike PI
bike_pi_exhibit <- add_sc_lc(bike_pi_sc_exhibit, bike_pi_lc_exhibit)

#Bike PPA
#bike_ppa_exhibit <- Reserve_Data$exhibit12_adj[Reserve_Data$PRODUCTS=="BIKE" & Reserve_Data$COV_NAME=="PPA" & Reserve_Data$CL_Large2=="Total"][[1]]

#Bike LawyerE
#bike_le_exhibit <- Reserve_Data$exhibit12_adj[Reserve_Data$PRODUCTS=="BIKE" & Reserve_Data$COV_NAME=="LawyerE" & Reserve_Data$CL_Large2=="Total"][[1]]

#Bike Total
drops <- c("AY", "EXPOSURE", "FF_LR", "EAXA_LR", "FREQ", "AVG_COST","AVG_EP", "EAXA_FREQ", "EAXA_AVG_COST")
bike_exhibit <- cbind(
  AY=bike_bil_exhibit[, "AY"],
  (
    bike_bil_exhibit[, !(names(bike_bil_exhibit) %in% drops)] +
      bike_pi_exhibit[, !(names(bike_pi_exhibit) %in% drops)] +
      bike_pdl_exhibit[, !(names(bike_pdl_exhibit) %in% drops)] +
      bike_ppa_exhibit[, !(names(bike_ppa_exhibit) %in% drops)] +
      bike_le_exhibit[, !(names(bike_le_exhibit) %in% drops)] 
  ),
  EXPOSURE = bike_bil_exhibit$EXPOSURE)
bike_exhibit <- stats_func(bike_exhibit)
bike_exhibit <- format_exhibit(bike_exhibit)

#Motor (Auto + Bike)

#Motor BIL Small
motor_bil_sc_exhibit <- add_auto_bike_exhibit(auto_bil_sc_exhibit, bike_bil_sc_exhibit)
#Motor BIL Large
motor_bil_lc_exhibit <- add_auto_bike_exhibit(auto_bil_lc_exhibit, bike_bil_lc_exhibit)
#Motor BIL
motor_bil_exhibit <- add_sc_lc(motor_bil_sc_exhibit, motor_bil_lc_exhibit)
#Motor PDL
motor_pdl_exhibit <- add_auto_bike_exhibit(auto_pdl_exhibit, bike_pdl_exhibit)
#Motor PI Small
motor_pi_sc_exhibit <- add_auto_bike_exhibit(auto_pi_sc_exhibit, bike_pi_sc_exhibit)
#Motor PI Large
motor_pi_lc_exhibit <- add_auto_bike_exhibit(auto_pi_lc_exhibit, bike_pi_lc_exhibit)
#Motor PI
motor_pi_exhibit <- add_sc_lc(motor_pi_sc_exhibit, motor_pi_lc_exhibit)
#Motor PPA
motor_ppa_exhibit <- add_auto_bike_exhibit(auto_ppa_exhibit, bike_ppa_exhibit)
#Motor LawyerE
motor_le_exhibit <- add_auto_bike_exhibit(auto_le_exhibit, bike_le_exhibit)
#Motor Total
drops <- c("AY", "EXPOSURE", "FF_LR", "EAXA_LR", "FREQ", "AVG_COST", "AVG_EP", "EAXA_FREQ", "EAXA_AVG_COST")
motor_exhibit <- cbind(
  AY=motor_bil_exhibit[, "AY"],
  (
    motor_bil_exhibit[, !(names(motor_bil_exhibit) %in% drops)] +
      motor_pi_exhibit[, !(names(motor_pi_exhibit) %in% drops)] +
      motor_pdl_exhibit[, !(names(motor_pdl_exhibit) %in% drops)] +
      motor_ppa_exhibit[, !(names(motor_ppa_exhibit) %in% drops)] +
      auto_od_pe_ev_exhibit[, !(names(auto_od_pe_ev_exhibit) %in% drops)] +
      auto_fb_exhibit[, !(names(auto_fb_exhibit) %in% drops)] +
      motor_le_exhibit[, !(names(motor_le_exhibit) %in% drops)] +
      auto_axap_exhibit[, !(names(auto_axap_exhibit) %in% drops)] +
      auto_eq_exhibit[, !(names(auto_eq_exhibit) %in% drops)]
  ),
  EXPOSURE = motor_bil_exhibit$EXPOSURE)
motor_exhibit <- stats_func(motor_exhibit)
motor_exhibit <- format_exhibit(motor_exhibit)

#Company Total###

company_exhibit <- add_motor_pet_pa_exhibit(motor_exhibit, pet_exhibit, pa_exhibit)


# For Summary -------------------------------------------------------------

#Make dataframe for graph--------------------

#For EAXA Plot---

lst <- list(auto_bil_lc_exhibit, auto_bil_sc_exhibit, auto_bil_exhibit, auto_pi_lc_exhibit, auto_pi_sc_exhibit, auto_pi_exhibit, auto_pdl_exhibit, auto_ppa_exhibit, auto_od_pe_ev_exhibit,
            auto_fb_exhibit, auto_le_exhibit, auto_axap_exhibit, auto_eq_exhibit, auto_exhibit, 
            bike_bil_lc_exhibit, bike_bil_sc_exhibit, bike_bil_exhibit, bike_pi_lc_exhibit, bike_pi_sc_exhibit,  bike_pi_exhibit, bike_pdl_exhibit, bike_ppa_exhibit, bike_le_exhibit, bike_exhibit,
            motor_bil_lc_exhibit, motor_bil_sc_exhibit, motor_bil_exhibit, motor_pi_lc_exhibit, motor_pi_sc_exhibit, motor_pi_exhibit, motor_pdl_exhibit, motor_ppa_exhibit, auto_od_pe_ev_exhibit,
            auto_fb_exhibit, motor_le_exhibit, auto_axap_exhibit, auto_eq_exhibit, motor_exhibit,
            pa_exhibit, pet_exhibit, company_exhibit)
lnm <- list("Auto_BIL_LC", "Auto_BIL_SC", "Auto_BIL", "Auto_PI_LC", "Auto_PI_SC", "Auto_PI", "Auto_PDL", "Auto_PPA", "Auto_ODPE", 
            "Auto_FB", "Auto_LE", "Auto_Axa+", "Auto_EQ", "Auto",
            "Bike_BIL_LC", "Bike_BIL_SC", "Bike_BIL", "Bike_PI_LC", "Bike_PI_SC", "Bike_PI", "Bike_PDL", "Bike_PPA", "Bike_LE", "Bike",
            "Motor_BIL_LC", "Motor_BIL_SC", "Motor_BIL", "Motor_PI_LC", "Motor_PI_SC", "Motor_PI", "Motor_PDL", "Motor_PPA", "Motor_ODPE", 
            "Motor_FB", "Motor_LE", "Motor_Axa+", "Motor_EQ", "Motor",
            "PA", "Pet", "Company")
all_cov <- c()
for(i in seq_along(lst)) {
  df <- lst[[i]] %>% 
    dplyr::mutate(cov=lnm[[i]])
  all_cov <- rbind(all_cov, df)
}
all_exhibit <- all_cov %>% 
  group_by(cov) %>% 
  nest() %>% 
  mutate(
    EAXA = data %>% map(calc_eaxa),
    EAXA_RES = data %>% map(get_eres),
    EAXA_LR = data %>% map(get_EAXA_LR),
    FF_LR = data %>% map(get_FF_LR),
    EAXA_FREQ = data %>% map(get_EAXA_FREQ),
    EAXA_AVG_COST = data %>% map(get_EAXA_AVG_COST)
  )

# summary_all table used for Flash report summary
summary_all <- all_exhibit %>% 
  unnest(EAXA_RES, EAXA_LR, FF_LR, EAXA_FREQ, EAXA_AVG_COST) %>% 
  dplyr::select(-data, -EAXA) %>% 
  dplyr::rename(CY_EAXA_RES = CY_Total, PY_EAXA_RES = PY_Total, Tot_EAXA_RES = Total,
                CY_EAXA_LR = CY_Total1, PY_EAXA_LR = PY_Total1, Tot_EAXA_LR = Total1,
                CY_FF_LR = CY_Total2, PY_FF_LR = PY_Total2, Tot_FF_LR = Total2,
                CY_EAXA_FREQ = CY_Total3, PY_EAXA_FREQ = PY_Total3, Tot_EAXA_FREQ = Total3,
                CY_EAXA_AVG_COST = CY_Total4, PY_EAXA_AVG_COST = PY_Total4, Tot_EAXA_AVG_COST = Total4
  )
#summary_all[, 2:4] <- summary_all[, 2:4] %>% map(accounting, 0)
#summary_all[, 5:10] <- summary_all[, 5:10] %>% map(percent, 2)
# ---

df_auto_graph_all <- all_exhibit %>%
  unnest(EAXA) %>% 
  dplyr::filter(str_detect(cov,"Auto"))
df_bike_graph_all <- all_exhibit %>%
  unnest(EAXA) %>% 
  dplyr::filter(str_detect(cov,"Bike"))
df_motor_graph_all <- all_exhibit %>%
  unnest(EAXA) %>% 
  dplyr::filter(str_detect(cov,"Motor"))
df_pa_pet_graph_all <- all_exhibit %>%
  unnest(EAXA) %>% 
  dplyr::filter(cov=="PA" | cov=="Pet")
df_company_graph_all <- all_exhibit %>%
  unnest(EAXA) %>% 
  dplyr::filter(cov=="Motor" | cov=="Auto" | cov=="Bike" | cov=="PA" | cov=="Pet" | cov=="Company")
df_company_graph_all$cov <- factor(df_company_graph_all$cov,levels = c("Motor", "Auto", "Bike", "PA", "Pet", "Company"))

#For stats plot---

#Auto---
auto_g_stats <- all_exhibit %>% 
  dplyr::select(cov, data) %>% ## need to check 
  unnest(data) %>% 
  dplyr::filter(str_detect(cov,"Auto")) %>% 
  dplyr::select(cov, AY, EAXA_LR, FREQ, AVG_COST, AVG_EP)



#Bike---

bike_g_stats <- all_exhibit %>% 
  dplyr::select(cov, data) %>% ## need to check 
  unnest(data) %>% 
  dplyr::filter(str_detect(cov,"Bike")) %>% 
  dplyr::select(cov, AY, EAXA_LR, FREQ, AVG_COST, AVG_EP)

#Motor---

motor_g_stats <- all_exhibit %>% 
  dplyr::select(cov, data) %>% ## need to check 
  unnest(data) %>% 
  dplyr::filter(str_detect(cov,"Motor")) %>% 
  dplyr::select(cov, AY, EAXA_LR, FREQ, AVG_COST, AVG_EP)

#PA & Pet---

pa_pet_g_stats <- all_exhibit %>% 
  dplyr::select(cov, data) %>% ## need to check 
  unnest(data) %>% 
  dplyr::filter(cov == "PA" | cov == "Pet") %>% 
  dplyr::select(cov, AY, EAXA_LR, FREQ, AVG_COST, AVG_EP)

#Company Total---
#Auto, Bike, Motor, PA, Pet, Company

co_g_stats <- all_exhibit %>% 
  dplyr::select(cov, data) %>% ## need to check 
  unnest(data) %>% 
  dplyr::filter(cov == "Motor" | cov == "Auto" | cov == "Bike" | cov == "PA" | cov == "Pet" | cov == "Company") %>% 
  dplyr::select(cov, AY, EAXA_LR, FREQ, AVG_COST, AVG_EP)

# Eaxa plot ---------------------------------------------------------------

#Auto
Eaxa_plot_func_comScale(df_auto_graph_all, "Auto", "Auto EAXA (Common Scale)")
Eaxa_plot_func_freeScale(df_auto_graph_all, "Auto EAXA (Free Scale)")
#Bike
Eaxa_plot_func_comScale(df_bike_graph_all, "Bike", "Bike EAXA (Common Scale)")
Eaxa_plot_func_freeScale(df_bike_graph_all, "Bike EAXA (Free Scale)")
#Motor
Eaxa_plot_func_comScale(df_motor_graph_all, "Motor", "Motor EAXA (Common Scale)")
Eaxa_plot_func_freeScale(df_motor_graph_all, "Motor EAXA (Free Scale)")
#PA Pet
Eaxa_plot_func_comScale(df_pa_pet_graph_all, "", "PA & Pet EAXA (Common Scale)")
Eaxa_plot_func_freeScale(df_pa_pet_graph_all, "PA & Pet EAXA (Free Scale)")
#Company
Eaxa_plot_func_comScale(df_company_graph_all, "", "Company EAXA (Common Scale)")
Eaxa_plot_func_freeScale(df_company_graph_all, "Company EAXA (Free Scale)")

#Stats Plot---

#EAXA LR

Eaxa_LR_plot_func(auto_g_stats, "Auto EAXA LR")
Eaxa_LR_plot_func(bike_g_stats, "Bike EAXA LR")
Eaxa_LR_plot_func(motor_g_stats, "Motor EAXA LR")
Eaxa_LR_plot_func(pa_pet_g_stats, "PA & Pet EAXA LR")
Eaxa_LR_plot_func(co_g_stats, "Company EAXA LR")


#Frequency
Freq_plot_func(auto_g_stats, "Auto F/F Freq")
Freq_plot_func(bike_g_stats, "Bike F/F Freq")
Freq_plot_func(motor_g_stats, "Motor F/F Freq")
Freq_plot_func(pa_pet_g_stats, "PA & Pet F/F Freq")
Freq_plot_func(co_g_stats, "Company F/F Freq")

#AVG Cost
#Non Large
AC_sc_plot_func(auto_g_stats, "Auto F/F AVG Cost")
AC_sc_plot_func(bike_g_stats, "Bike F/F AVG Cost")
AC_sc_plot_func(motor_g_stats, "Motor F/F AVG Cost")
AC_sc_plot_func(pa_pet_g_stats, "PA & Pet F/F AVG Cost")
AC_sc_plot_func(co_g_stats, "Company F/F AVG Cost")

#BI and PI Large
AC_lc_plot_func(auto_g_stats, "Auto F/F AVG Cost")
AC_lc_plot_func(bike_g_stats, "Bike F/F AVG Cost")
AC_lc_plot_func(motor_g_stats, "Motor F/F AVG Cost")

#Average EP
Avg_ep_plot_func(auto_g_stats, "Auto AVG EP")
Avg_ep_plot_func(bike_g_stats, "Bike AVG EP")
Avg_ep_plot_func(motor_g_stats, "Motor AVG EP")
Avg_ep_plot_func(pa_pet_g_stats, "PA & Pet AVG EP")
Avg_ep_plot_func(co_g_stats, "Company AVG EP")



```

Summary {data-orientation=rows}
=====================================  
    
Row
-------------------------------------

### Summary

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(summary_all, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "Summary", format = "pandoc")

#########################################################################################
```

Motor {data-orientation=rows, data-navmenu="Motor"}
=====================================  
    
Row
-------------------------------------

### Motor

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(motor_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "Motor Total", format = "pandoc")

#########################################################################################
```

BIL {data-orientation=rows, data-navmenu="Motor"}
=====================================  
    
Row
-------------------------------------

### Motor

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(motor_bil_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "BIL", format = "pandoc")

```


BIL_LC {data-orientation=rows, data-navmenu="Motor"}
=====================================  
    
Row
-------------------------------------

### Motor

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(motor_bil_lc_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "BIL_LC", format = "pandoc")

```

BIL_SC {data-orientation=rows, data-navmenu="Motor"}
=====================================  
    
Row
-------------------------------------

### Motor

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(motor_bil_sc_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "BIL_SC", format = "pandoc")

```

PI {data-orientation=rows, data-navmenu="Motor"}
=====================================  
    
Row
-------------------------------------

### Motor

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(motor_pi_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "PI", format = "pandoc")

```


PI_LC {data-orientation=rows, data-navmenu="Motor"}
=====================================  
    
Row
-------------------------------------

### Motor

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(motor_pi_lc_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "PI_LC", format = "pandoc")

```

PI_SC {data-orientation=rows, data-navmenu="Motor"}
=====================================  
    
Row
-------------------------------------

### Motor

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(motor_pi_sc_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "PI_SC", format = "pandoc")

```

PDL {data-orientation=rows, data-navmenu="Motor"}
=====================================  
    
Row
-------------------------------------

### Motor

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(motor_pdl_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "PDL", format = "pandoc")

```

PPA {data-orientation=rows, data-navmenu="Motor"}
=====================================  
    
Row
-------------------------------------

### Motor

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(motor_ppa_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "PPA", format = "pandoc")

```

OD_PE {data-orientation=rows, data-navmenu="Motor"}
=====================================  
    
Row
-------------------------------------

### Motor

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_odpe_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "OD_PE", format = "pandoc")

```

OD_CAT {data-orientation=rows, data-navmenu="Motor"}
=====================================  
    
Row
-------------------------------------

### Motor

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_odpe_ev_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "OD_CAT", format = "pandoc")

```

FB {data-orientation=rows, data-navmenu="Motor"}
=====================================  
    
Row
-------------------------------------

### Motor

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_fb_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "Family_Bike", format = "pandoc")

```

LE {data-orientation=rows, data-navmenu="Motor"}
=====================================  
    
Row
-------------------------------------

### Motor

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(motor_le_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "Lawyer_Expense", format = "pandoc")

```

AXAP {data-orientation=rows, data-navmenu="Motor"}
=====================================  
    
Row
-------------------------------------

### Motor

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_axap_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "AXA_Plus", format = "pandoc")

```

EQ {data-orientation=rows, data-navmenu="Motor"}
=====================================  
    
Row
-------------------------------------

### Motor

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_eq_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "EQ", format = "pandoc")

```

Graph {data-orientation=rows, data-navmenu="Motor"}
=====================================  
    
Row
-------------------------------------

### Motor

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

#Motor
Eaxa_plot_func_comScale(df_motor_graph_all, "Motor", "Motor EAXA (Common Scale)")
Eaxa_plot_func_freeScale(df_motor_graph_all, "Motor EAXA (Free Scale)")
Eaxa_LR_plot_func(motor_g_stats, "Motor EAXA LR")
Freq_plot_func(motor_g_stats, "Motor F/F Freq")
AC_sc_plot_func(motor_g_stats, "Motor F/F AVG Cost")
AC_lc_plot_func(motor_g_stats, "Motor F/F AVG Cost")
Avg_ep_plot_func(motor_g_stats, "Motor AVG EP")

```

Auto {data-orientation=rows, data-navmenu="Auto"}
=====================================  
    
Row
-------------------------------------

### Auto

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "Auto Total", format = "pandoc")

#########################################################################################
```

BIL {data-orientation=rows, data-navmenu="Auto"}
=====================================  
    
Row
-------------------------------------

### Auto

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_bil_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "BIL", format = "pandoc")
```


BIL_LC {data-orientation=rows, data-navmenu="Auto"}
=====================================  
    
Row
-------------------------------------

### Auto

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_bil_lc_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "BIL_LC", format = "pandoc")
auto_bil_lc_ldf_plot
auto_bil_lc_er_models_plot
triangle_plot(auto_bil_lc_fulltri, "BIL Large Claims: EAXA Incurred")
triangle_plot(auto_bil_lc_lr_tri, "BIL Large Claims: EAXA LR")
triangle_plot(auto_bil_lc_freq_tri, "BIL Large Claims: Frequency")
triangle_plot(auto_bil_lc_ac_tri, "BIL Large Claims: Severity")
triangle_plot(auto_bil_lc_bc_tri, "BIL Large Claims: Burning Cost")

```

BIL_SC {data-orientation=rows, data-navmenu="Auto"}
=====================================  
    
Row
-------------------------------------

### Auto

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_bil_sc_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "BIL_SC", format = "pandoc")
auto_bil_sc_ldf_plot
auto_bil_sc_er_models_plot
triangle_plot(auto_bil_sc_fulltri[-c(1:124), -c((dim(auto_bil_sc_fulltri)[2]-124+1):dim(auto_bil_sc_fulltri)[2])], "BIL Attritional Claims: EAXA Incurred")
triangle_plot(auto_bil_sc_lr_tri[-c(1:124), -c((dim(auto_bil_sc_lr_tri)[2]-124+1):dim(auto_bil_sc_lr_tri)[2])], "BIL Attritional Claims: EAXA LR")
triangle_plot(auto_bil_sc_freq_tri[-c(1:124), -c((dim(auto_bil_sc_freq_tri)[2]-124+1):dim(auto_bil_sc_freq_tri)[2])], "BIL Attritional Claims: Frequency")
triangle_plot(auto_bil_sc_ac_tri[-c(1:124), -c((dim(auto_bil_sc_ac_tri)[2]-124+1):dim(auto_bil_sc_ac_tri)[2])], "BIL Attritional Claims: Severity")
triangle_plot(auto_bil_sc_bc_tri[-c(1:124), -c((dim(auto_bil_sc_bc_tri)[2]-124+1):dim(auto_bil_sc_bc_tri)[2])], "BIL Attritional Claims: Burning Cost")
```

PI {data-orientation=rows, data-navmenu="Auto"}
=====================================  
    
Row
-------------------------------------

### Auto

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_pi_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "PI", format = "pandoc")

```


PI_LC {data-orientation=rows, data-navmenu="Auto"}
=====================================  
    
Row
-------------------------------------

### Auto

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_pi_lc_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "PI_LC", format = "pandoc")
auto_pi_lc_ldf_plot
auto_pi_lc_er_models_plot
triangle_plot(auto_pi_lc_fulltri, "PI Large Claims: EAXA Incurred")
triangle_plot(auto_pi_lc_lr_tri, "PI Large Claims: EAXA LR")
triangle_plot(auto_pi_lc_freq_tri, "PI Large Claims: Frequency")
triangle_plot(auto_pi_lc_ac_tri, "PI Large Claims: Severity")
triangle_plot(auto_pi_lc_bc_tri, "PI Large Claims: Burning Cost")


```

PI_SC {data-orientation=rows, data-navmenu="Auto"}
=====================================  
    
Row
-------------------------------------

### Auto

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_pi_sc_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "PI_SC", format = "pandoc")
auto_pi_sc_ldf_plot
auto_pi_sc_er_models_plot
triangle_plot(auto_pi_sc_fulltri, "PI Attritional Claims: EAXA Incurred")
triangle_plot(auto_pi_sc_lr_tri, "PI Attritional Claims: EAXA LR")
triangle_plot(auto_pi_sc_freq_tri, "PI Attritional Claims: Frequency")
triangle_plot(auto_pi_sc_ac_tri, "PI Attritional Claims: Severity")
triangle_plot(auto_pi_sc_bc_tri, "PI Attritional Claims: Burning Cost")

```

PDL {data-orientation=rows, data-navmenu="Auto"}
=====================================  
    
Row
-------------------------------------

### Auto

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_pdl_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "PDL", format = "pandoc")
auto_pdl_ldf_plot
auto_pdl_er_models_plot
triangle_plot(auto_pdl_fulltri, "PDL Claims: EAXA Incurred")
triangle_plot(auto_pdl_lr_tri, "PDL Claims: EAXA LR")
triangle_plot(auto_pdl_freq_tri, "PDL Claims: Frequency")
triangle_plot(auto_pdl_ac_tri, "PDL Claims: Severity")
triangle_plot(auto_pdl_bc_tri, "PDL Claims: Burning Cost")

```

PPA {data-orientation=rows, data-navmenu="Auto"}
=====================================  
    
Row
-------------------------------------

### Auto

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_ppa_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "PPA", format = "pandoc")
auto_ppa_ldf_plot
auto_ppa_er_models_plot
triangle_plot(auto_ppa_fulltri, "PPA Claims: EAXA Incurred")
triangle_plot(auto_ppa_lr_tri, "PPA Claims: EAXA LR")
triangle_plot(auto_ppa_freq_tri, "PPA Claims: Frequency")
triangle_plot(auto_ppa_ac_tri, "PPA Claims: Severity")
triangle_plot(auto_ppa_bc_tri, "PPA Claims: Burning Cost")


```

OD_PE {data-orientation=rows, data-navmenu="Auto"}
=====================================  
    
Row
-------------------------------------

### Auto

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_odpe_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "OD_PE", format = "pandoc")
auto_odpe_ldf_plot
auto_odpe_er_models_plot
triangle_plot(auto_odpe_fulltri[-c(1:124), -c((dim(auto_odpe_fulltri)[2]-124+1):dim(auto_odpe_fulltri)[2])], "OD_PE Claims: EAXA Incurred")
triangle_plot(auto_odpe_lr_tri[-c(1:124), -c((dim(auto_odpe_lr_tri)[2]-124+1):dim(auto_odpe_lr_tri)[2])], "OD_PE Claims: EAXA LR")
triangle_plot(auto_odpe_freq_tri[-c(1:124), -c((dim(auto_odpe_freq_tri)[2]-124+1):dim(auto_odpe_freq_tri)[2])], "OD_PE Claims: Frequency")
triangle_plot(auto_odpe_ac_tri[-c(1:124), -c((dim(auto_odpe_ac_tri)[2]-124+1):dim(auto_odpe_ac_tri)[2])], "OD_PE Claims: Severity")
triangle_plot(auto_odpe_bc_tri[-c(1:124), -c((dim(auto_odpe_bc_tri)[2]-124+1):dim(auto_odpe_bc_tri)[2])], "OD_PE Claims: Burning Cost")

```

OD_CAT {data-orientation=rows, data-navmenu="Auto"}
=====================================  
    
Row
-------------------------------------

### Auto

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_odpe_ev_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "OD_CAT", format = "pandoc")
auto_odpe_ev_ldf_plot
auto_odpe_ev_er_models_plot
triangle_plot(auto_odpe_ev_fulltri, "OD_CAT Claims: EAXA Incurred")
triangle_plot(auto_odpe_ev_lr_tri, "OD_CAT Claims: EAXA LR")
triangle_plot(auto_odpe_ev_freq_tri, "OD_CAT Claims: Frequency")
triangle_plot(auto_odpe_ev_ac_tri, "OD_CAT Claims: Severity")
triangle_plot(auto_odpe_ev_bc_tri, "OD_CAT Claims: Burning Cost")


```

FB {data-orientation=rows, data-navmenu="Auto"}
=====================================  
    
Row
-------------------------------------

### Auto

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_fb_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "Family_Bike", format = "pandoc")
auto_fb_ldf_plot
auto_fb_er_models_plot
triangle_plot(auto_fb_fulltri, "Family_Bike Claims: EAXA Incurred")
triangle_plot(auto_fb_lr_tri, "Family_Bike Claims: EAXA LR")
triangle_plot(auto_fb_freq_tri, "Family_Bike Claims: Frequency")
triangle_plot(auto_fb_ac_tri, "Family_Bike Claims: Severity")
triangle_plot(auto_fb_bc_tri, "Family_Bike Claims: Burning Cost")


```

LE {data-orientation=rows, data-navmenu="Auto"}
=====================================  
    
Row
-------------------------------------

### Auto

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_le_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "Lawyer_Expense", format = "pandoc")
auto_le_ldf_plot
auto_le_er_models_plot
triangle_plot(auto_le_fulltri, "Lawyer_Expense Claims: EAXA Incurred")
triangle_plot(auto_le_lr_tri, "Lawyer_Expense Claims: EAXA LR")
triangle_plot(auto_le_freq_tri, "Lawyer_Expense Claims: Frequency")
triangle_plot(auto_le_ac_tri, "Lawyer_Expense Claims: Severity")
triangle_plot(auto_le_bc_tri, "Lawyer_Expense Claims: Burning Cost")

```

AXAP {data-orientation=rows, data-navmenu="Auto"}
=====================================  
    
Row
-------------------------------------

### Auto

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_axap_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "AXA_Plus", format = "pandoc")
auto_axap_ldf_plot
auto_axap_er_models_plot
triangle_plot(auto_axap_fulltri, "AXA_Plus Claims: EAXA Incurred")
triangle_plot(auto_axap_lr_tri, "AXA_Plus Claims: EAXA LR")
triangle_plot(auto_axap_freq_tri, "AXA_Plus Claims: Frequency")
triangle_plot(auto_axap_ac_tri, "AXA_Plus Claims: Severity")
triangle_plot(auto_axap_bc_tri, "AXA_Plus Claims: Burning Cost")

```

EQ {data-orientation=rows, data-navmenu="Auto"}
=====================================  
    
Row
-------------------------------------

### Auto

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(auto_eq_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "EQ", format = "pandoc")
auto_eq_ldf_plot
auto_eq_er_models_plot
triangle_plot(auto_eq_fulltri, "AXA_Plus Claims: EAXA Incurred")
triangle_plot(auto_eq_lr_tri, "AXA_Plus Claims: EAXA LR")
triangle_plot(auto_eq_freq_tri, "AXA_Plus Claims: Frequency")
triangle_plot(auto_eq_ac_tri, "AXA_Plus Claims: Severity")
triangle_plot(auto_eq_bc_tri, "AXA_Plus Claims: Burning Cost")

```

Graph {data-orientation=rows, data-navmenu="Auto"}
=====================================  
    
Row
-------------------------------------

### Auto

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

#Auto
Eaxa_plot_func_comScale(df_auto_graph_all, "Auto", "Auto EAXA (Common Scale)")
Eaxa_plot_func_freeScale(df_auto_graph_all, "Auto EAXA (Free Scale)")
Eaxa_LR_plot_func(auto_g_stats, "Auto EAXA LR")
Freq_plot_func(auto_g_stats, "Auto F/F Freq")
AC_sc_plot_func(auto_g_stats, "Auto F/F AVG Cost")
AC_lc_plot_func(auto_g_stats, "Auto F/F AVG Cost")
Avg_ep_plot_func(auto_g_stats, "Auto AVG EP")

```

Bike {data-orientation=rows, data-navmenu="Bike"}
=====================================  
    
Row
-------------------------------------

### Bike

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(bike_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "Bike Total", format = "pandoc")

#########################################################################################
```

BIL {data-orientation=rows, data-navmenu="Bike"}
=====================================  
    
Row
-------------------------------------

### Bike

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(bike_bil_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "BIL", format = "pandoc")
```


BIL_LC {data-orientation=rows, data-navmenu="Bike"}
=====================================  
    
Row
-------------------------------------

### Bike

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(bike_bil_lc_exhibit, format.args = list(decimal.mark = '.', big.mark = ","), caption = "BIL_LC", format = "pandoc")
bike_bil_lc_ldf_plot
bike_bil_lc_er_models_plot
triangle_plot(bike_bil_lc_fulltri, "BIL Large Claims: EAXA Incurred")
triangle_plot(bike_bil_lc_lr_tri, "BIL Large Claims: EAXA LR")
triangle_plot(bike_bil_lc_freq_tri, "BIL Large Claims: Frequency")
triangle_plot(bike_bil_lc_ac_tri, "BIL Large Claims: Severity")
triangle_plot(bike_bil_lc_bc_tri, "BIL Large Claims: Burning Cost")

```

BIL_SC {data-orientation=rows, data-navmenu="Bike"}
=====================================  
    
Row
-------------------------------------

### Bike

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(bike_bil_sc_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "BIL_SC", format = "pandoc")
bike_bil_sc_ldf_plot
bike_bil_sc_er_models_plot
triangle_plot(bike_bil_sc_fulltri[-c(1:60), -c((dim(bike_bil_sc_fulltri)[2]-60+1):dim(bike_bil_sc_fulltri)[2])], "BIL Attritional Claims: EAXA Incurred")
triangle_plot(bike_bil_sc_lr_tri[-c(1:60), -c((dim(bike_bil_sc_lr_tri)[2]-60+1):dim(bike_bil_sc_lr_tri)[2])], "BIL Attritional Claims: EAXA LR")
triangle_plot(bike_bil_sc_freq_tri[-c(1:60), -c((dim(bike_bil_sc_freq_tri)[2]-60+1):dim(bike_bil_sc_freq_tri)[2])], "BIL Attritional Claims: Frequency")
triangle_plot(bike_bil_sc_ac_tri[-c(1:60), -c((dim(bike_bil_sc_ac_tri)[2]-60+1):dim(bike_bil_sc_ac_tri)[2])], "BIL Attritional Claims: Severity")
triangle_plot(bike_bil_sc_bc_tri[-c(1:60), -c((dim(bike_bil_sc_bc_tri)[2]-60+1):dim(bike_bil_sc_bc_tri)[2])], "BIL Attritional Claims: Burning Cost")

```

PI {data-orientation=rows, data-navmenu="Bike"}
=====================================  
    
Row
-------------------------------------

### Bike

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(bike_pi_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "PI", format = "pandoc")

```


PI_LC {data-orientation=rows, data-navmenu="Bike"}
=====================================  
    
Row
-------------------------------------

### Bike

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(bike_pi_lc_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "PI_LC", format = "pandoc")
bike_pi_lc_ldf_plot
bike_pi_lc_er_models_plot
triangle_plot(bike_pi_lc_fulltri, "PI Large Claims: EAXA Incurred")
triangle_plot(bike_pi_lc_lr_tri, "PI Large Claims: EAXA LR")
triangle_plot(bike_pi_lc_freq_tri, "PI Large Claims: Frequency")
triangle_plot(bike_pi_lc_ac_tri, "PI Large Claims: Severity")
triangle_plot(bike_pi_lc_bc_tri, "PI Large Claims: Burning Cost")

```

PI_SC {data-orientation=rows, data-navmenu="Bike"}
=====================================  
    
Row
-------------------------------------

### Bike

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(bike_pi_sc_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "PI_SC", format = "pandoc")
bike_pi_sc_ldf_plot
bike_pi_sc_er_models_plot
triangle_plot(bike_pi_sc_fulltri[-c(1:60), -c((dim(bike_pi_sc_fulltri)[2]-60+1):dim(bike_pi_sc_fulltri)[2])], "PI Attritional Claims: EAXA Incurred")
triangle_plot(bike_pi_sc_lr_tri[-c(1:60), -c((dim(bike_pi_sc_lr_tri)[2]-60+1):dim(bike_pi_sc_lr_tri)[2])], "PI Attritional Claims: EAXA LR")
triangle_plot(bike_pi_sc_freq_tri[-c(1:60), -c((dim(bike_pi_sc_freq_tri)[2]-60+1):dim(bike_pi_sc_freq_tri)[2])], "PI Attritional Claims: Frequency")
triangle_plot(bike_pi_sc_ac_tri[-c(1:60), -c((dim(bike_pi_sc_ac_tri)[2]-60+1):dim(bike_pi_sc_ac_tri)[2])], "PI Attritional Claims: Severity")
triangle_plot(bike_pi_sc_bc_tri[-c(1:60), -c((dim(bike_pi_sc_bc_tri)[2]-60+1):dim(bike_pi_sc_bc_tri)[2])], "PI Attritional Claims: Burning Cost")

```

PDL {data-orientation=rows, data-navmenu="Bike"}
=====================================  
    
Row
-------------------------------------

### Bike

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(bike_pdl_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "PDL", format = "pandoc")
bike_pdl_ldf_plot
bike_pdl_er_models_plot
triangle_plot(bike_pdl_fulltri[-c(1:60), -c((dim(bike_pdl_fulltri)[2]-60+1):dim(bike_pdl_fulltri)[2])], "PDL Claims: EAXA Incurred")
triangle_plot(bike_pdl_lr_tri[-c(1:60), -c((dim(bike_pdl_lr_tri)[2]-60+1):dim(bike_pdl_lr_tri)[2])], "PDL Claims: EAXA LR")
triangle_plot(bike_pdl_freq_tri[-c(1:60), -c((dim(bike_pdl_freq_tri)[2]-60+1):dim(bike_pdl_freq_tri)[2])], "PDL Claims: Frequency")
triangle_plot(bike_pdl_ac_tri[-c(1:60), -c((dim(bike_pdl_ac_tri)[2]-60+1):dim(bike_pdl_ac_tri)[2])], "PDL Claims: Severity")
triangle_plot(bike_pdl_bc_tri[-c(1:60), -c((dim(bike_pdl_bc_tri)[2]-60+1):dim(bike_pdl_bc_tri)[2])], "PDL Claims: Burning Cost")

```

PPA {data-orientation=rows, data-navmenu="Bike"}
=====================================  
    
Row
-------------------------------------

### Bike

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(bike_ppa_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "PPA", format = "pandoc")
bike_ppa_ldf_plot
bike_ppa_er_models_plot
triangle_plot(bike_ppa_fulltri[-c(1:60), -c((dim(bike_ppa_fulltri)[2]-60+1):dim(bike_ppa_fulltri)[2])], "PPA Claims: EAXA Incurred")
triangle_plot(bike_ppa_lr_tri[-c(1:60), -c((dim(bike_ppa_lr_tri)[2]-60+1):dim(bike_ppa_lr_tri)[2])], "PPA Claims: EAXA LR")
triangle_plot(bike_ppa_freq_tri[-c(1:60), -c((dim(bike_ppa_freq_tri)[2]-60+1):dim(bike_ppa_freq_tri)[2])], "PPA Claims: Frequency")
triangle_plot(bike_ppa_ac_tri[-c(1:60), -c((dim(bike_ppa_ac_tri)[2]-60+1):dim(bike_ppa_ac_tri)[2])], "PPA Claims: Severity")
triangle_plot(bike_ppa_bc_tri[-c(1:60), -c((dim(bike_ppa_bc_tri)[2]-60+1):dim(bike_ppa_bc_tri)[2])], "PPA Claims: Burning Cost")

```

LE {data-orientation=rows, data-navmenu="Bike"}
=====================================  
    
Row
-------------------------------------

### Bike

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(bike_le_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "Lawyer_Expense", format = "pandoc")
bike_le_ldf_plot
bike_le_er_models_plot
triangle_plot(bike_le_fulltri, "Lawyer_Expense Claims: EAXA Incurred")
triangle_plot(bike_le_lr_tri, "Lawyer_Expense Claims: EAXA LR")
triangle_plot(bike_le_freq_tri, "Lawyer_Expense Claims: Frequency")
triangle_plot(bike_le_ac_tri, "Lawyer_Expense Claims: Severity")
triangle_plot(bike_le_bc_tri, "Lawyer_Expense Claims: Burning Cost")

```

Graph {data-orientation=rows, data-navmenu="Bike"}
=====================================  
    
Row
-------------------------------------

### Bike

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

#Bike
Eaxa_plot_func_comScale(df_bike_graph_all, "Bike", "Bike EAXA (Common Scale)")
Eaxa_plot_func_freeScale(df_bike_graph_all, "Bike EAXA (Free Scale)")
Eaxa_LR_plot_func(bike_g_stats, "Bike EAXA LR")
Freq_plot_func(bike_g_stats, "Bike F/F Freq")
AC_sc_plot_func(bike_g_stats, "Bike F/F AVG Cost")
AC_lc_plot_func(bike_g_stats, "Bike F/F AVG Cost")
Avg_ep_plot_func(bike_g_stats, "Bike AVG EP")

```

Pet {data-orientation=rows, data-navmenu="Pet_PA"}
=====================================  
    
Row
-------------------------------------

### Pet

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(pet_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "Pet", format = "pandoc")
pet_ldf_plot
pet_er_models_plot
triangle_plot(pet_fulltri, "Pet Claims: EAXA Incurred")
triangle_plot(pet_lr_tri, "Pet Claims: EAXA LR")
triangle_plot(pet_freq_tri, "Pet Claims: Frequency")
triangle_plot(pet_ac_tri, "Pet Claims: Severity")
triangle_plot(pet_bc_tri, "Pet Claims: Burning Cost")
```

PA {data-orientation=rows, data-navmenu="Pet_PA"}
=====================================  
    
Row
-------------------------------------

### PA

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(pa_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "PA", format = "pandoc")
pa_ldf_plot
pa_er_models_plot
triangle_plot(pa_fulltri, "PA Claims: EAXA Incurred")
triangle_plot(pa_lr_tri, "PA Claims: EAXA LR")
triangle_plot(pa_freq_tri, "PA Claims: Frequency")
triangle_plot(pa_ac_tri, "PA Claims: Severity")
triangle_plot(pa_bc_tri, "PA Claims: Burning Cost")

```

Graph {data-orientation=rows, data-navmenu="Pet_PA"}
=====================================  
    
Row
-------------------------------------

### Pet

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

#Pet
Eaxa_plot_func_comScale(df_pa_pet_graph_all, "", "Pet & PA EAXA (Common Scale)")
#Eaxa_plot_func_freeScale(df_pa_pet_graph_all, "Pet & PA EAXA (Free Scale)")
Eaxa_LR_plot_func(pa_pet_g_stats, "Pet & PA EAXA LR")
Freq_plot_func(pa_pet_g_stats, "Pet & PA F/F Freq")
AC_sc_plot_func(pa_pet_g_stats, "Pet & PA F/F AVG Cost")
Avg_ep_plot_func(pa_pet_g_stats, "Pet & PA AVG EP")

```

Company {data-orientation=rows, data-navmenu="Company"}
=====================================  
    
Row
-------------------------------------

### Company

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

kable(company_exhibit, format.args = list(decimal.mark = '.', big.mark = ","),
      caption = "Company", format = "pandoc")
```

Graph {data-orientation=rows, data-navmenu="Company"}
=====================================  
    
Row
-------------------------------------

### Company

```{r, echo=FALSE, waring=FALSE, message=FALSE, results='asis', fig.height = 12, fig.width = 15}

#Pet
Eaxa_plot_func_comScale(df_company_graph_all, "", "Company EAXA (Common Scale)")
Eaxa_plot_func_freeScale(df_company_graph_all, "Company EAXA (Free Scale)")
Eaxa_LR_plot_func(co_g_stats, "Company EAXA LR")
Freq_plot_func(co_g_stats, "Company F/F Freq")
AC_sc_plot_func(co_g_stats, "Company F/F AVG Cost")
Avg_ep_plot_func(co_g_stats, "Company AVG EP")

```
